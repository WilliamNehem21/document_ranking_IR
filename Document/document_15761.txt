With Thessalonica secured, Vatatzes turned to Epirus, offering Michael II a marriage alliance between Michael's eldest son Nikephoros and his own granddaughter Maria. The offer was enthusiastically accepted by Michael's wife, Theodora Petraliphaina (a niece of Theodore's own wife), and the young couple were engaged at Pegae. Michael, who had not abandoned his family's ambitions, remained ambivalent about the Nicaean alliance, and Theodore used his influence over his nephew to turn him against it. Thus, in spring 1251, Michael launched a sudden attack on Thessalonica. The city resisted successfully, and in spring of the next year Vatatzes once more crossed into Europe to campaign against the Komnenoi Doukai. Theodore with Michael had turned to the north, capturing Prilep and Veles, and when they received news of Vatatzes' arrival, they withdrew to Epirus via Kastoria. Vatatzes besieged and captured Theodore's stronghold of Vodena, but soon became bogged down in skirmishing in the area of Kastoria. The stalemate was broken when two Epirote generals, John Glabas and Theodore Petraliphas, defected to the Nicaeans, followed shortly after by the ruler of Kruja, Golem. This forced Michael to come to terms with Vatatzes, ceding the fortresses he had captured as well as his remaining holdings in Macedonia, and reconfirming the marriage alliance with Nicaea. Furthermore, Vatatzes explicitly demanded the handing over of Theodore. The Epirote ambassadors met Vatatzes at Vodena, where they offered Theodore and the young Nikephoros as hostages. The latter was granted the title of Despot and soon allowed to return to Epirus, but Theodore was moved as a prisoner to Asia Minor. He died shortly after, around 1253.