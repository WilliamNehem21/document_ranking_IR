Before undertaking any moves against Constantinople, Vatatzes realized the need to settle affairs with Thessalonica, and in particular with Theodore, whose ambition, capability, and machinations he feared. In 1240 or 1241 he therefore issued an invitation, with assurances of safe-conduct, to Theodore to visit Nicaea. Theodore accepted, and was treated with great honours by Vatatzes, who deferred to him as his "uncle" and dined with him at the same table. In reality, Theodore was a prisoner in Nicaea; he was not allowed to leave, and throughout his sojourn in the Nicaean court, preparations were in full swing for a campaign against Thessalonica. In spring 1242, Vatatzes crossed over into Europe at the head of his army, with Theodore accompanying him as an honorary prisoner. Facing no resistance, the Nicaean army and fleet arrived before Thessalonica. The city's garrison and inhabitants resisted with success and the Nicaean army, lacking heavy siege equipment, had to settle for a drawn-out blockade. Soon, however, news arrived of a Mongol invasion of Asia Minor, which forced Vatatzes to break off the campaign and return to Nicaea. Nevertheless, the Nicaean emperor kept this news a secret, and sent Theodore to his son to negotiate. John himself reportedly was willing to surrender the city outright, but his father convinced him to hold out for better terms. In the end, after 40 days of negotiations, John was allowed to keep control of Thessalonica, but renounced his imperial title and accepted Nicaean suzerainty and the title of Despot. Theodore was also allowed to remain at Thessalonica at his son's side.