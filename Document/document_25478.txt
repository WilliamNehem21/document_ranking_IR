Two days after Knox arrived in Edinburgh, he proceeded to Dundee where a large number of Protestant sympathisers had gathered. Knox was declared an outlaw, and the Queen Regent summoned the Protestants to Stirling. Fearing the possibility of a summary trial and execution, the Protestants proceeded instead to Perth, a walled town that could be defended in case of a siege. At the church of St John the Baptist, Knox preached a fiery sermon and a small incident precipitated into a riot. A mob poured into the church and it was soon gutted. The mob then attacked two friaries in the town, looting their gold and silver and smashing images. Mary of Guise gathered those nobles loyal to her and a small French army. She dispatched the Earl of Argyll and Lord Moray to offer terms and avert a war. She promised not to send any French troops into Perth if the Protestants evacuated the town. The Protestants agreed, but when the Queen Regent entered Perth, she garrisoned it with Scottish soldiers on the French pay roll. This was seen as treacherous by Lord Argyll and Lord Moray, who both switched sides and joined Knox, who now based himself in St Andrews. Knox's return to St Andrews fulfilled the prophecy he made in the galleys that he would one day preach again in its church. When he did give a sermon, the effect was the same as in Perth. The people engaged in vandalism and looting.